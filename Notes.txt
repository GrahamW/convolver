Example 3D convolve, indexing.

 Image shape = [3,4,4]

  0        1        2        3        4        5        6        7        8        9       10       11
 f[0,0,0] f[1,0,0] f[2,0,0] f[0,1,0] f[1,1,0] f[2,1,0] f[0,2,0] f[1,2,0] f[2,2,0] f[0,3,0] f[1,3,0] f[2,3,0]

 12       13       14       15       16       17       18       19       20       21       22       23
 f[0,0,1] f[1,0,1] f[2,0,1] f[0,1,1] f[1,1,1] f[2,1,1] f[0,2,1] f[1,2,1] f[2,2,1] f[0,3,1] f[1,3,1] f[2,3,1]

 24       25       26       27       28       29       30       31       32       33       34       35
 f[0,0,2] f[1,0,2] f[2,0,2] f[0,1,2] f[1,1,2] f[2,1,2] f[0,2,2] f[1,2,2] f[2,2,2] f[0,3,2] f[1,3,2] f[2,3,2]

 36       37       38       39       40       41       42       43       44       45       46       47
 f[0,0,3] f[1,0,3] f[2,0,3] f[0,1,3] f[1,1,3] f[2,1,3] f[0,2,3] f[1,2,3] f[2,2,3] f[0,3,3] f[1,3,3] f[2,3,3]


 A convolve with a kernel [2,2,2], starting from image position 13, f[1,0,1]:

 Shape Indices: f[1,0,1], f[2,0,1], f[1,1,1], f[2,1,1], f[1,0,2], f[2,0,2], f[1,1,2], f[2,1,2]

 Raw Indices: 13, 14, 16, 17, 25, 26, 28, 29.

 16 - 14 = 2 = 1 + IS[0] - KS[0]
 25 - 17 = 8 = 1 + IS[0] - KS[0] + IS[0] * ( IS[1] - KS[1] )

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

 Image shape = [4,5,6]

  0         1         2         3         4         5         6         7         8         9
  [0,0,0]   [1,0,0]   [2,0,0]   [3,0,0]   [0,1,0]   [1,1,0]   [2,1,0]   [3,1,0]   [0,2,0]   [1,2,0]

 10        11        12        13        14        15        16        17        18        19
  [2,2,0]   [3,2,0]   [0,3,0]   [1,3,0]   [2,3,0]   [3,3,0]   [0,4,0]   [1,4,0]   [2,4,0]   [3,4,0]

 20        21        22        23        24        25        26        27        28        29
  [0,0,1]   [1,0,1]   [2,0,1]   [3,0,1]   [0,1,1]   [1,1,1]   [2,1,1]   [3,1,1]   [0,2,1]   [1,2,1]

 30        31        32        33        34        35        36        37        38        39
  [2,2,1]   [3,2,1]   [0,3,1]   [1,3,1]   [2,3,1]   [3,3,1]   [0,4,1]   [1,4,1]   [2,4,1]   [3,4,1]

 40        41        42        43        44        45        46        47        48        49
  [0,0,2]   [1,0,2]   [2,0,2]   [3,0,2]   [0,1,2]   [1,1,2]   [2,1,2]   [3,1,2]   [0,2,2]   [1,2,2]

 50        51        52        53        54        55        56        57        58        59
  [2,2,2]   [3,2,2]   [0,3,2]   [1,3,2]   [2,3,2]   [3,3,2]   [0,4,2]   [1,4,2]   [2,4,2]   [3,4,2]

 60        61        62        63        64        65        66        67        68        69
  [0,0,3]   [1,0,3]   [2,0,3]   [3,0,3]   [0,1,3]   [1,1,3]   [2,1,3]   [3,1,3]   [0,2,3]   [1,2,3]

 70        71        72        73        74        75        76        77        78        79
  [2,2,3]   [3,2,3]   [0,3,3]   [1,3,3]   [2,3,3]   [3,3,3]   [0,4,3]   [1,4,3]   [2,4,3]   [3,4,3]

 80        81        82        83        84        85        86        87        88        89
  [0,0,4]   [1,0,4]   [2,0,4]   [3,0,4]   [0,1,4]   [1,1,4]   [2,1,4]   [3,1,4]   [0,2,4]   [1,2,4]

 90        91        92        93        94        95        96        97        98        99
  [2,2,4]   [3,2,4]   [0,3,4]   [1,3,4]   [2,3,4]   [3,3,4]   [0,4,4]   [1,4,4]   [2,4,4]   [3,4,4]

100       101       102       103       104       105       106       107       108       109
  [0,0,5]   [1,0,5]   [2,0,5]   [3,0,5]   [0,1,5]   [1,1,5]   [2,1,5]   [3,1,5]   [0,2,5]   [1,2,5]

110       111       112       113       114       115       116       117       118       119
  [2,2,5]   [3,2,5]   [0,3,5]   [1,3,5]   [2,3,5]   [3,3,5]   [0,4,5]   [1,4,5]   [2,4,5]   [3,4,5]


 A convolve with a kernel [2,2,2], starting from image position 13, [1,3,0]

 Shape Indices: [1,3,0], [2,3,0], [1,4,0], [2,4,0], [1,3,1], [2,3,1], [1,4,1], [2,4,1]

 Raw Indices: 13, 14, 17, 18, 33, 34, 37, 38.

 17 - 14 =  3 => 1 + IS[0] - KS[0]
 33 - 18 = 15 => 1 + IS[0] - KS[0] + IS[0] * ( IS[1] - KS[1] )  =  1 + (4 - 2) + 4 * ( 5 - 2 )
